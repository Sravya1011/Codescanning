name: Java CodeQL

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  analyze:
    name: Analyze with CodeQL
    runs-on: ubuntu-latest
    strategy:
      matrix:
        language: ['java']
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up JDK 11
      uses: actions/setup-java@v1
      with:
        java-version: 11

    - name: Set up CodeQL
      uses: github/codeql-action/init@v1
      with:
        languages: ${{ matrix.language }}
        # If you need to analyze a codebase which uses multiple languages,
        # add the additional language(s) here and adjust your queries accordingly
        # languages: java, javascript

    - name: Build with Maven
      run: mvn clean install -DskipTests=true

    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v1
      with:
        # Path to the CodeQL database. Change this to match your build system.
        # Maven default is target/codeql-db
        # Gradle default is build/codeql/db
        # If you have a different layout, modify this path accordingly
        database-path: target/codeql-db
        # Path to the SARIF file that will be produced as output
        sarif-file: codeql.sarif
